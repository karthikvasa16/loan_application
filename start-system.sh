#!/bin/bash\n\n# Kubera Loan Application System Startup Script\n# This script sets up and starts the complete loan application system\n\necho \"ðŸš€ Starting Kubera Loan Application System\"\necho \"==========================================\"\n\n# Colors for output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m' # No Color\n\n# Function to print colored output\nprint_status() {\n    echo -e \"${BLUE}[INFO]${NC} $1\"\n}\n\nprint_success() {\n    echo -e \"${GREEN}[SUCCESS]${NC} $1\"\n}\n\nprint_warning() {\n    echo -e \"${YELLOW}[WARNING]${NC} $1\"\n}\n\nprint_error() {\n    echo -e \"${RED}[ERROR]${NC} $1\"\n}\n\n# Check if Node.js is installed\nif ! command -v node &> /dev/null; then\n    print_error \"Node.js is not installed. Please install Node.js first.\"\n    exit 1\nfi\n\n# Check if npm is installed\nif ! command -v npm &> /dev/null; then\n    print_error \"npm is not installed. Please install npm first.\"\n    exit 1\nfi\n\nprint_status \"Node.js version: $(node --version)\"\nprint_status \"npm version: $(npm --version)\"\n\n# Check if PostgreSQL is running\nif ! pg_isready -q; then\n    print_warning \"PostgreSQL is not running. Please start PostgreSQL first.\"\n    print_status \"You can start PostgreSQL with: sudo service postgresql start\"\nfi\n\n# Install backend dependencies\nprint_status \"Installing backend dependencies...\"\ncd server\nif npm install; then\n    print_success \"Backend dependencies installed successfully\"\nelse\n    print_error \"Failed to install backend dependencies\"\n    exit 1\nfi\n\n# Install frontend dependencies\nprint_status \"Installing frontend dependencies...\"\ncd ../client\nif npm install; then\n    print_success \"Frontend dependencies installed successfully\"\nelse\n    print_error \"Failed to install frontend dependencies\"\n    exit 1\nfi\n\n# Go back to root directory\ncd ..\n\n# Create uploads directory\nprint_status \"Creating uploads directory...\"\nmkdir -p server/uploads/documents\nprint_success \"Uploads directory created\"\n\n# Check if .env files exist\nif [ ! -f \"server/.env\" ]; then\n    print_warning \"Backend .env file not found. Creating sample .env file...\"\n    cat > server/.env << EOF\n# Database Configuration\nDB_HOST=localhost\nDB_PORT=5432\nDB_NAME=kubera_db\nDB_USER=postgres\nDB_PASSWORD=your_password_here\n\n# JWT Secret\nJWT_SECRET=your-super-secret-jwt-key-change-in-production\n\n# Server Configuration\nPORT=5000\nNODE_ENV=development\n\n# Email Configuration (Optional)\nEMAIL_HOST=smtp.gmail.com\nEMAIL_PORT=587\nEMAIL_USER=your-email@gmail.com\nEMAIL_PASS=your-app-password\nEMAIL_FROM=noreply@kubera.gov.in\nEOF\n    print_warning \"Please update server/.env with your database credentials\"\nfi\n\nif [ ! -f \"client/.env\" ]; then\n    print_warning \"Frontend .env file not found. Creating sample .env file...\"\n    cat > client/.env << EOF\n# API Configuration\nREACT_APP_API_URL=http://localhost:5000/api\n\n# Other Configuration\nREACT_APP_ENV=development\nEOF\n    print_success \"Frontend .env file created\"\nfi\n\n# Function to start backend\nstart_backend() {\n    print_status \"Starting backend server...\"\n    cd server\n    npm start &\n    BACKEND_PID=$!\n    cd ..\n    print_success \"Backend server started (PID: $BACKEND_PID)\"\n}\n\n# Function to start frontend\nstart_frontend() {\n    print_status \"Starting frontend development server...\"\n    cd client\n    npm start &\n    FRONTEND_PID=$!\n    cd ..\n    print_success \"Frontend server started (PID: $FRONTEND_PID)\"\n}\n\n# Function to cleanup on exit\ncleanup() {\n    print_status \"Shutting down servers...\"\n    if [ ! -z \"$BACKEND_PID\" ]; then\n        kill $BACKEND_PID 2>/dev/null\n        print_success \"Backend server stopped\"\n    fi\n    if [ ! -z \"$FRONTEND_PID\" ]; then\n        kill $FRONTEND_PID 2>/dev/null\n        print_success \"Frontend server stopped\"\n    fi\n    exit 0\n}\n\n# Set up signal handlers\ntrap cleanup SIGINT SIGTERM\n\n# Start servers\nstart_backend\nsleep 3  # Give backend time to start\nstart_frontend\n\nprint_success \"Kubera Loan Application System is now running!\"\necho \"\"\nprint_status \"Backend API: http://localhost:5000\"\nprint_status \"Frontend App: http://localhost:3000\"\nprint_status \"API Documentation: http://localhost:5000/api/health\"\necho \"\"\nprint_status \"Press Ctrl+C to stop all servers\"\necho \"\"\n\n# Test the system\nprint_status \"Testing system health...\"\nsleep 5\n\nif curl -s http://localhost:5000/api/health > /dev/null; then\n    print_success \"Backend is healthy âœ…\"\nelse\n    print_error \"Backend health check failed âŒ\"\nfi\n\nif curl -s http://localhost:3000 > /dev/null; then\n    print_success \"Frontend is accessible âœ…\"\nelse\n    print_warning \"Frontend may still be starting up...\"\nfi\n\necho \"\"\nprint_status \"ðŸŽ¯ Quick Start Guide:\"\necho \"   1. Open http://localhost:3000 in your browser\"\necho \"   2. Register a new student account or login\"\necho \"   3. Navigate to the loan application form\"\necho \"   4. Fill out all steps and submit your application\"\necho \"\"\nprint_status \"ðŸ“š Available API Endpoints:\"\necho \"   POST /api/loans/applications - Create new application\"\necho \"   PUT  /api/loans/applications/:id - Update application\"\necho \"   POST /api/loans/applications/:id/submit - Submit application\"\necho \"   POST /api/loans/applications/:id/documents/:type - Upload document\"\necho \"   GET  /api/loans/applications/:id - Get application details\"\necho \"   GET  /api/loans/applications - Get all applications\"\necho \"\"\n\n# Keep script running\nwhile true; do\n    sleep 1\ndone\n